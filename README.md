# 소스 코드 공개 했습니다. 
# 엑셀파일 업로드 해도 별도 저장 안됩니다. 

# LedgerCompare

거래 원장 비교 분석 애플리케이션

## 📋 개요

**LedgerCompare**는 이카운트에서 발급한 회사 원장들을 간단하게 비교할 수 있는 프로그램입니다.  
두 개의 엑셀 원장 파일을 업로드하여 거래 내역을 자동으로 분석하고, 불일치 항목을 시각적으로 찾을 수 있습니다.

---

## ✨ 주요 기능

### 🎯 대시보드 (요약 분석)
- **거래 요약 통계**: 판매, 수금, 구매, 지급 금액 한눈에 확인
- **일자별 비교**: 날짜별 거래 합계를 비교하여 불일치 항목 자동 발견
- **불일치 분석**: 불일치 거래일, 편차 금액, 최대/최소 편차 통계
- **실시간 필터링**: "불일치만 보기" 토글로 문제 거래 집중 분석

### 🔍 상세 분석 (거래별 상세 검토)
- **날짜별 필터링**: 특정 날짜의 거래만 선택적으로 조회
- **유형별 필터링**: 판매/구매 또는 수금/지급 비교 선택
- **상태별 필터링**: 일치, 불일치, 미매칭 거래 구분
- **색상 강조**: 
  - 🟢 **초록색** = 금액 일치 (문제 없음)
  - 🔴 **빨강색** = 금액 불일치 (검토 필요)
  - ⚪ **회색** = 한쪽만 있음 (미매칭)

### 💾 데이터 내보내기
- CSV 형식으로 분석 결과 다운로드
- 대시보드 요약본 및 상세 거래내역 별도 저장 가능

---

## 🚀 설치 및 실행

### 필수 요구사항
- Python 3.8 이상
- pip (Python 패키지 관리자)

### 설치 단계

1. **저장소 클론**
   ```bash
   git clone https://github.com/yourusername/LedgerCompare.git
   cd LedgerCompare
   ```

2. **필수 패키지 설치**
   ```bash
   pip install -r requirements.txt
   ```

3. **Streamlit 애플리케이션 실행**
   ```bash
   streamlit run app.py
   ```

4. **웹 브라우저 접속**
   ```
   http://localhost:8501
   ```

---

## 📦 필수 패키지

```
pandas>=1.3.0
streamlit>=1.0.0
openpyxl>=3.6.0
```

자세한 내용은 `requirements.txt` 참고

---

## 📁 파일 구조

```
LedgerCompare/
├── app.py                    # 메인 애플리케이션
├── requirements.txt          # 필수 패키지 목록
├── README.md                 # 프로젝트 설명 (이 파일)
└── sample_data/             # 샘플 원장 파일 (선택사항)
    ├── example_ledger1.xlsx
    └── example_ledger2.xlsx
```

---

## 💡 사용 방법

### 1단계: 파일 준비
- 비교할 2개의 엑셀 원장 파일 준비 (`.xlsx` 형식)
- 파일 형식: 이카운트 거래처관리대장

### 2단계: 파일 업로드
1. LedgerCompare 애플리케이션 실행
2. 좌측 사이드바에서 2개 파일 선택

### 3단계: 대시보드 분석
- 요약 통계로 전체 거래 현황 파악
- 일자별 비교 테이블에서 불일치 항목 확인
- 불일치 거래 통계로 문제 규모 파악

### 4단계: 상세 분석
- 특정 날짜 선택
- 거래 유형 선택 (판매/구매 또는 수금/지급)
- 필터 적용하여 문제 거래 상세 검토

### 5단계: 결과 저장
- CSV 다운로드 버튼으로 분석 결과 내보내기

---

## 🔄 비교 로직

### 핵심 원칙
거래는 양쪽 회사에서 반대 관점으로 기록됩니다:

| 관점 | 구분 | 컬럼 |
|------|------|------|
| **A회사 입장** | 채권판매 | 3열 |
| **A회사 입장** | 채무구매 | 5열 |
| **B회사 입장** | 채무구매 | 5열 |
| **B회사 입장** | 채권판매 | 3열 |

**비교 기준:**
- A회사 채권판매 금액 = B회사 채무구매 금액 (같은 거래)
- A회사 채무구매 금액 = B회사 채권판매 금액 (같은 거래)

---

## 📊 출력 예시

### 대시보드
```
┌─────────────────────────────────────┐
│ 채권판매: 50,000,000원              │
│ 채권수금: 48,500,000원              │
│ 미수금: 1,500,000원                 │
└─────────────────────────────────────┘

일자별 비교 (불일치 항목)
┌───────────┬──────────┬──────────┬──────────┬─────────┐
│ 일자      │ 판매금액 │ 구매금액 │ 편차     │ 상태    │
├───────────┼──────────┼──────────┼──────────┼─────────┤
│ 2022/01/03│ 3,400,000│ 4,600,000│ -1,200,00│ ❌      │
│ 2022/01/05│ 5,250,000│ 5,250,000│ 0        │ ✅      │
└───────────┴──────────┴──────────┴──────────┴─────────┘
```

### 상세 분석
```
2022/01/03 거래 상세 (5개 거래)

거래번호 │ A회사 적요          │ 금액        │ B회사 적요          │ 금액        │ 상태
────────┼────────────────────┼─────────────┼────────────────────┼─────────────┼──────
1       │ 웜오디오 컴프레셔   │ 1,080,000   │ 웜오디오 컴프레셔   │ 1,080,000   │ ✅
2       │ SL88 그랜드         │ 836,364     │ SL88 그랜드         │ 920,000     │ ❌
3       │ IN-5 블랙           │ 632,000     │ IN-5 블랙           │ 632,000     │ ✅
```

---

## ⚙️ 시스템 요구사항

- **OS**: Windows, macOS, Linux
- **Python**: 3.8 이상
- **메모리**: 최소 2GB (대용량 파일 분석시 4GB 이상 권장)
- **브라우저**: Chrome, Firefox, Safari, Edge (최신 버전)

---

## 🐛 트러블슈팅

### Q1: "파일을 읽을 수 없습니다" 에러가 발생합니다
**A**: 
- 파일이 `.xlsx` 형식인지 확인하세요
- 파일이 손상되지 않았는지 확인하세요
- Excel에서 파일을 열어 정상적으로 보이는지 확인하세요

### Q2: 비교 결과에 "미매칭" 거래가 많습니다
**A**:
- 한쪽 원장에만 기록된 거래입니다
- 거래 누락이나 기록 오류가 있을 수 있으니 두 회사에 확인하세요

### Q3: 금액이 조금 다릅니다
**A**:
- 환율, 할인, 세금 등이 반영되어 다를 수 있습니다
- 상세 분석 페이지에서 거래 내용을 확인하세요

### Q4: 애플리케이션이 느립니다
**A**:
- 매우 큰 파일(10MB 이상)을 업로드했을 가능성이 있습니다
- 파일을 분할하여 분석해보세요
- 컴퓨터 메모리 상태를 확인하세요

---

## 📝 파일 형식 요구사항

### 지원하는 파일
- **형식**: Microsoft Excel (`.xlsx`)
- **구조**: 이카운트 거래처관리대장
- **필수 항목**:
  - 1-2행: 헤더 정보
  - 3행부터: 거래 데이터
  - 0열: 일자 (형식: YYYY/MM/DD)
  - 3열: 채권판매 금액
  - 4열: 채권수금 금액
  - 5열: 채무구매 금액
  - 6열: 채무지급 금액

### 지원하지 않는 파일
- `.xls` (구형 Excel)
- `.csv` (쉼표 구분)
- `.json` 등 기타 형식

---

## 🤝 기여 (Contribution)

이 프로젝트에 기여하고 싶으신가요?

1. Fork this repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

---

## 📄 라이선스

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## 👨‍💻 개발자

**LedgerCompare** - 거래 원장 비교 분석 도구

---

## 📞 지원 및 문의

문제가 발생하거나 기능 요청이 있으신 경우:

1. **GitHub Issues**: [Issues 페이지](https://github.com/yourusername/LedgerCompare/issues)로 문제 등록
2. **Email**: your.email@example.com
3. **Discussion**: [Discussions](https://github.com/yourusername/LedgerCompare/discussions)에서 질문

---

## 🎓 학습 자료

- [Pandas 공식 문서](https://pandas.pydata.org/)
- [Streamlit 공식 문서](https://docs.streamlit.io/)
- [Excel 파일 다루기](https://openpyxl.readthedocs.io/)

---


**Last Updated**: 2024년 10월  
**Version**: 1.0.0

---

**즐겁게 사용해주세요! 🎉**
